import{_ as O,m as B,c as l,a as s,t as p,w as f,v as b,b as q,e as E,h as F,q as M,F as m,r as x,s as I,d as v,o as d,u as _}from"./index.8305bc38.js";import"https://cdn.jsdelivr.net/npm/@feathersjs/client@5.0.0-pre.28/+esm";import"https://cdn.jsdelivr.net/npm/socket.io-client@4.5.1/+esm";const J={inject:["io"],methods:{toggle(){this.custom=!this.custom},async list(){let t=await this.io.service("types/any").find({query:{slug:this.type,$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}}});this.response=t,this.listRow()},async listRow(){let t={$or:[]};this.fields.forEach(r=>{var n;if(((n=this.keys[r])==null?void 0:n.type)==="String"){let g={};g[r]={$regex:this.search},t.$or.push(g)}}),(!t.$or.length||!this.search)&&delete t.$or;let e=await this.io.service("types/"+this.type).find({query:{...t,$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}}});e.data=e.data.map(r=>this.decode(r)),this.responseRow=e},async create(t){await this.io.service("types/"+this.type).create(t),this.clear(),this.list()},async save(t){await this.io.service("types/"+this.type).patch(t._id,this.encode(t)),this.list()},async remove(t){await this.io.service("types/"+this.type).remove(t._id),this.list()},clear(){this.obj={}},decode(t){return Object.keys(this.keys).forEach(e=>{var g,o;let r=(g=this.keys[e])!=null&&g.intl?"object":(o=this.keys[e])==null?void 0:o.type;typeof r=="string"&&(r=r.toLowerCase());let n=r===typeof t[e]||r==="buffer"&&typeof t[e]=="object";if(n&&r==="object")try{t[e]=JSON.stringify(t[e])}catch{}else if(n&&r==="buffer")try{t[e]=new TextDecoder().decode(t[e])}catch{}}),t},encode(t){let e={...t};return Object.keys(this.keys).forEach(r=>{var o,c;let n=(o=this.keys[r])!=null&&o.intl?"object":(c=this.keys[r])==null?void 0:c.type;typeof n=="string"&&(n=n.toLowerCase());let g=typeof e[r];if(n==="object"&&g==="string")try{e[r]=JSON.parse(e[r])}catch{}else if(n==="buffer"&&g==="string")try{e[r]=new TextEncoder().encode(e[r]).buffer}catch{}}),e},nextPage(){this.page++,this.list()},prevPage(){this.page--,this.list()}},computed:{instance(){var t;return((t=this.response)==null?void 0:t.data[0])||{}},fields(){var t,e;return(t=this.instance)!=null&&t.fields&&(this.keys=(e=this.instance)==null?void 0:e.fields),Object.keys(this.keys)},table(){var t;return((t=this.responseRow)==null?void 0:t.data)||[]},decodedContent(){var t,e,r;if((t=this.response)!=null&&t.data.length){let n=(r=(e=this.response)==null?void 0:e.data[0])==null?void 0:r.dashboard;return new TextDecoder().decode(n)}return""},loadedComponent(){let t=URL.createObjectURL(new Blob([this.decodedContent],{type:"text/javascript"}));return B(async()=>await I(()=>import(t),[]))}},data:()=>({keys:[],obj:{},limit:25,page:1,response:null,responseRow:null,search:"",custom:!0}),props:{type:{type:String,default:"components"}},created(){this.list()},watch:{type(){this.list()}},setup(){}},K={style:{display:"flex",height:"100%","font-family":"Arial, Helvetica, sans-serif"}},H={style:{width:"100%","flex-grow":"1",flex:"1",height:"100%",overflow:"auto","background-color":"#edebebff"}},G={style:{"margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px"}},Q={style:{color:"#2b2b2bff"}},W=v(),X=v(),Y={key:0,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ebf2f5ff"}},Z=["disabled"],$=["disabled"],tt={key:1,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ffffffff"}},et={key:2},it={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff"}},ot={style:{display:"inline-block"}},st=s("input",{style:{"margin-right":"5px"},placeholder:"id",readonly:""},null,-1),rt=["onUpdate:modelValue","placeholder"],at={style:{display:"inline-block",float:"right"}},dt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}},nt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#83b5c9ff",position:"relative"}},lt={style:{display:"inline-block",float:"right"}},pt=["onClick"],gt=["onClick"],ht=v(),ct={style:{display:"inline-block",width:"100%"}},ut={style:{"font-size":"13px",position:"absolute",top:"3px",color:"#1c1c1cff","font-weight":"bold"}},ft={style:{position:"absolute",top:"3px","font-size":"13px",right:"21px",color:"#1c1c1cff","font-weight":"bold"}},bt=["onUpdate:modelValue"],mt=["onUpdate:modelValue","placeholder"],xt=["onUpdate:modelValue","placeholder"],yt=["onUpdate:modelValue","placeholder"],vt=v(),_t={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}};function wt(t,e,r,n,g,o){var c,y,w,C,k,R,P,V,U,j,D,S,z,L,T,A;return d(),l("div",K,[s("div",H,[s("div",G,[s("h2",Q,p((y=(c=o.instance)==null?void 0:c.title)==null?void 0:y.en),1),W,s("button",{type:"",onClick:e[0]||(e[0]=(...i)=>o.list&&o.list(...i)),style:{float:"right"}}," Refresh "),f(s("input",{style:{"margin-right":"5px",width:"167px",float:"right"},"onUpdate:modelValue":e[1]||(e[1]=i=>t.search=i),placeholder:"Filter",onKeydown:e[2]||(e[2]=q((...i)=>o.list&&o.list(...i),["enter"]))},null,544),[[b,t.search]])]),X,o.decodedContent?(d(),l("div",Y,[s("button",{type:"",onClick:e[3]||(e[3]=(...i)=>o.toggle&&o.toggle(...i)),disabled:t.custom}," Custom view ",8,Z),s("button",{type:"",onClick:e[4]||(e[4]=(...i)=>o.toggle&&o.toggle(...i)),disabled:!t.custom}," Default view ",8,$)])):E("",!0),t.custom&&o.decodedContent?(d(),l("div",tt,[(d(),F(M(o.loadedComponent)))])):(d(),l("div",et,[s("div",it,[s("div",ot,[st,(d(!0),l(m,null,x(o.fields,i=>f((d(),l("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":a=>t.obj[i]=a,placeholder:i},null,8,rt)),[[b,t.obj[i]]])),256))]),s("div",at,[s("button",{type:"",onClick:e[5]||(e[5]=i=>o.create(t.obj))}," Create ")])]),s("div",dt,[s("button",{type:"",onClick:e[6]||(e[6]=(...i)=>o.prevPage&&o.prevPage(...i)),style:{float:"left"}}," Previous page "),s("span",null," Page "+p(t.page)+" of "+p(Math.ceil(((w=t.responseRow)==null?void 0:w.total)/((C=t.responseRow)==null?void 0:C.limit)))+" ("+p((k=t.responseRow)==null?void 0:k.skip)+" - "+p(((R=t.responseRow)==null?void 0:R.skip)+((V=(P=t.responseRow)==null?void 0:P.data)==null?void 0:V.length))+" of "+p((U=t.responseRow)==null?void 0:U.total)+") ",1),s("button",{type:"",onClick:e[7]||(e[7]=(...i)=>o.nextPage&&o.nextPage(...i)),style:{float:"right"}}," Next page ")]),(d(!0),l(m,null,x(o.table,i=>(d(),l("div",nt,[s("div",lt,[s("button",{type:"",style:{"margin-right":"10px"},onClick:a=>o.save(i)}," Save ",8,pt),s("button",{type:"",onClick:a=>o.remove(i)}," Remove ",8,gt)]),ht,s("div",ct,[s("div",null,[s("span",ut," Created "+p(new Date(i.createdAt).toLocaleString()),1),s("span",ft," Updated "+p(new Date(i.updatedAt).toLocaleString()),1)]),f(s("input",{placeholder:"ID",style:{"margin-right":"5px"},"onUpdate:modelValue":a=>i._id=a,readonly:""},null,8,bt),[[b,i._id]]),(d(!0),l(m,null,x(o.fields,a=>{var h;return f((d(),l("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":u=>i[a]=u,placeholder:a},null,8,mt)),[[b,i[a]],[_,(h=i[a])==null?void 0:h.en]])}),256)),(d(!0),l(m,null,x(o.fields,a=>{var h;return f((d(),l("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":u=>i[a]=u,placeholder:a},null,8,xt)),[[b,i[a]],[_,(h=i[a])==null?void 0:h.no]])}),256)),(d(!0),l(m,null,x(o.fields,a=>{var h,u;return f((d(),l("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":N=>i[a]=N,placeholder:a},null,8,yt)),[[b,i[a]],[_,!((h=i[a])!=null&&h.en)&&!((u=i[a])!=null&&u.no)]])}),256)),vt,E("",!0)])]))),256)),s("div",_t,[s("button",{type:"",onClick:e[8]||(e[8]=(...i)=>o.prevPage&&o.prevPage(...i)),style:{float:"left"}}," Previous page "),s("span",null," Page "+p(t.page)+" of "+p(Math.ceil(((j=t.responseRow)==null?void 0:j.total)/((D=t.responseRow)==null?void 0:D.limit)))+" ("+p((S=t.responseRow)==null?void 0:S.skip)+" - "+p(((z=t.responseRow)==null?void 0:z.skip)+((T=(L=t.responseRow)==null?void 0:L.data)==null?void 0:T.length))+" of "+p((A=t.responseRow)==null?void 0:A.total)+") ",1),s("button",{type:"",onClick:e[9]||(e[9]=(...i)=>o.nextPage&&o.nextPage(...i)),style:{float:"right"}}," Next page ")])]))])])}const Pt=O(J,[["render",wt]]);export{Pt as default};
