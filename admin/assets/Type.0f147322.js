import{_ as O,m as B,c as n,a as s,t as l,w as f,v as m,b as q,e as E,h as F,q as M,F as x,r as y,s as I,d as _,o as d,u as w}from"./index.f7b5e10d.js";import"https://cdn.jsdelivr.net/npm/@feathersjs/client@5.0.0-pre.28/+esm";import"https://cdn.jsdelivr.net/npm/socket.io-client@4.5.1/+esm";const J={inject:["io"],methods:{toggle(){this.custom=!this.custom},async list(){let t=await this.io.service("types/any").find({query:{slug:this.type,$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}}});this.response=t,this.listRow()},async listRow(){let t={$or:[]};this.fields.forEach(r=>{var p;if(((p=this.keys[r])==null?void 0:p.type)==="String"){let g={};g[r]={$regex:this.search},t.$or.push(g)}}),(!t.$or.length||!this.search)&&delete t.$or;let e=await this.io.service("types/"+this.type).find({query:{...t,$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}}});e.data=e.data.map(r=>this.decode(r)),this.responseRow=e},async create(t){await this.io.service("types/"+this.type).create(t),this.clear(),this.list()},async save(t){await this.io.service("types/"+this.type).patch(t._id,this.encode(t)),this.list()},async remove(t){await this.io.service("types/"+this.type).remove(t._id),this.list()},clear(){this.obj={}},decode(t){return Object.keys(this.keys).forEach(e=>{var g,i,h;let r=(g=this.keys[e])!=null&&g.intl?"object":(h=(i=this.keys[e])==null?void 0:i.type)==null?void 0:h.toLowerCase();console.log(e,r,typeof t[e]);let p=r===typeof t[e]||r==="buffer"&&typeof t[e]=="object";if(p&&r==="object")try{t[e]=JSON.stringify(t[e])}catch{}else if(p&&r==="buffer")try{t[e]=new TextDecoder().decode(t[e])}catch{}}),t},encode(t){let e={...t};return Object.keys(this.keys).forEach(r=>{var i,h,u;let p=(i=this.keys[r])!=null&&i.intl?"object":(u=(h=this.keys[r])==null?void 0:h.type)==null?void 0:u.toLowerCase(),g=typeof e[r];if(p==="object"&&g==="string")try{e[r]=JSON.parse(e[r])}catch{}else if(p==="buffer"&&g==="string")try{e[r]=new TextEncoder().encode(e[r]).buffer}catch{}}),e},nextPage(){this.page++,this.list()},prevPage(){this.page--,this.list()}},computed:{instance(){var t;return((t=this.response)==null?void 0:t.data[0])||{}},fields(){var t,e;return(t=this.instance)!=null&&t.fields&&(this.keys=(e=this.instance)==null?void 0:e.fields),Object.keys(this.keys)},table(){var t;return((t=this.responseRow)==null?void 0:t.data)||[]},decodedContent(){var t,e,r;if((t=this.response)!=null&&t.data.length){let p=(r=(e=this.response)==null?void 0:e.data[0])==null?void 0:r.dashboard;return new TextDecoder().decode(p)}return""},loadedComponent(){let t=URL.createObjectURL(new Blob([this.decodedContent],{type:"text/javascript"}));return B(async()=>await I(()=>import(t),[]))}},data:()=>({keys:[],obj:{},limit:25,page:1,response:null,responseRow:null,search:"",custom:!0}),props:{type:{type:String,default:"components"}},created(){this.list()},watch:{type(){this.list()}},setup(){}},K={style:{display:"flex",height:"100%","font-family":"Arial, Helvetica, sans-serif"}},H={style:{width:"100%","flex-grow":"1",flex:"1",height:"100%",overflow:"auto","background-color":"#edebebff"}},G={style:{"margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px"}},Q={style:{color:"#2b2b2bff"}},W=_(),X=_(),Y={key:0,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ebf2f5ff"}},Z=["disabled"],$=["disabled"],tt={key:1,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ffffffff"}},et={key:2},ot={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff"}},it={style:{display:"inline-block"}},st=s("input",{style:{"margin-right":"5px"},placeholder:"id",readonly:""},null,-1),rt=["onUpdate:modelValue","placeholder"],at={style:{display:"inline-block",float:"right"}},dt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}},nt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#83b5c9ff",position:"relative"}},lt={style:{display:"inline-block",float:"right"}},pt=["onClick"],gt=["onClick"],ht=_(),ct={style:{display:"inline-block",width:"100%"}},ut={style:{"font-size":"13px",position:"absolute",top:"3px",color:"#1c1c1cff","font-weight":"bold"}},bt={style:{position:"absolute",top:"3px","font-size":"13px",right:"21px",color:"#1c1c1cff","font-weight":"bold"}},ft=["onUpdate:modelValue"],mt=["onUpdate:modelValue","placeholder"],xt=["onUpdate:modelValue","placeholder"],yt=["onUpdate:modelValue","placeholder"],vt=_(),_t={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}};function wt(t,e,r,p,g,i){var h,u,v,C,R,k,P,V,U,D,j,S,z,L,T,A;return d(),n("div",K,[s("div",H,[s("div",G,[s("h2",Q,l((u=(h=i.instance)==null?void 0:h.title)==null?void 0:u.en),1),W,s("button",{type:"",onClick:e[0]||(e[0]=(...o)=>i.list&&i.list(...o)),style:{float:"right"}}," Refresh "),f(s("input",{style:{"margin-right":"5px",width:"167px",float:"right"},"onUpdate:modelValue":e[1]||(e[1]=o=>t.search=o),placeholder:"Filter",onKeydown:e[2]||(e[2]=q((...o)=>i.list&&i.list(...o),["enter"]))},null,544),[[m,t.search]])]),X,i.decodedContent?(d(),n("div",Y,[s("button",{type:"",onClick:e[3]||(e[3]=(...o)=>i.toggle&&i.toggle(...o)),disabled:t.custom}," Custom view ",8,Z),s("button",{type:"",onClick:e[4]||(e[4]=(...o)=>i.toggle&&i.toggle(...o)),disabled:!t.custom}," Default view ",8,$)])):E("",!0),t.custom&&i.decodedContent?(d(),n("div",tt,[(d(),F(M(i.loadedComponent)))])):(d(),n("div",et,[s("div",ot,[s("div",it,[st,(d(!0),n(x,null,y(i.fields,o=>f((d(),n("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":a=>t.obj[o]=a,placeholder:o},null,8,rt)),[[m,t.obj[o]]])),256))]),s("div",at,[s("button",{type:"",onClick:e[5]||(e[5]=o=>i.create(t.obj))}," Create ")])]),s("div",dt,[s("button",{type:"",onClick:e[6]||(e[6]=(...o)=>i.prevPage&&i.prevPage(...o)),style:{float:"left"}}," Previous page "),s("span",null," Page "+l(t.page)+" of "+l(Math.ceil(((v=t.responseRow)==null?void 0:v.total)/((C=t.responseRow)==null?void 0:C.limit)))+" ("+l((R=t.responseRow)==null?void 0:R.skip)+" - "+l(((k=t.responseRow)==null?void 0:k.skip)+((V=(P=t.responseRow)==null?void 0:P.data)==null?void 0:V.length))+" of "+l((U=t.responseRow)==null?void 0:U.total)+") ",1),s("button",{type:"",onClick:e[7]||(e[7]=(...o)=>i.nextPage&&i.nextPage(...o)),style:{float:"right"}}," Next page ")]),(d(!0),n(x,null,y(i.table,o=>(d(),n("div",nt,[s("div",lt,[s("button",{type:"",style:{"margin-right":"10px"},onClick:a=>i.save(o)}," Save ",8,pt),s("button",{type:"",onClick:a=>i.remove(o)}," Remove ",8,gt)]),ht,s("div",ct,[s("div",null,[s("span",ut," Created "+l(new Date(o.createdAt).toLocaleString()),1),s("span",bt," Updated "+l(new Date(o.updatedAt).toLocaleString()),1)]),f(s("input",{placeholder:"ID",style:{"margin-right":"5px"},"onUpdate:modelValue":a=>o._id=a,readonly:""},null,8,ft),[[m,o._id]]),(d(!0),n(x,null,y(i.fields,a=>{var c;return f((d(),n("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":b=>o[a]=b,placeholder:a},null,8,mt)),[[m,o[a]],[w,(c=o[a])==null?void 0:c.en]])}),256)),(d(!0),n(x,null,y(i.fields,a=>{var c;return f((d(),n("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":b=>o[a]=b,placeholder:a},null,8,xt)),[[m,o[a]],[w,(c=o[a])==null?void 0:c.no]])}),256)),(d(!0),n(x,null,y(i.fields,a=>{var c,b;return f((d(),n("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":N=>o[a]=N,placeholder:a},null,8,yt)),[[m,o[a]],[w,!((c=o[a])!=null&&c.en)&&!((b=o[a])!=null&&b.no)]])}),256)),vt,E("",!0)])]))),256)),s("div",_t,[s("button",{type:"",onClick:e[8]||(e[8]=(...o)=>i.prevPage&&i.prevPage(...o)),style:{float:"left"}}," Previous page "),s("span",null," Page "+l(t.page)+" of "+l(Math.ceil(((D=t.responseRow)==null?void 0:D.total)/((j=t.responseRow)==null?void 0:j.limit)))+" ("+l((S=t.responseRow)==null?void 0:S.skip)+" - "+l(((z=t.responseRow)==null?void 0:z.skip)+((T=(L=t.responseRow)==null?void 0:L.data)==null?void 0:T.length))+" of "+l((A=t.responseRow)==null?void 0:A.total)+") ",1),s("button",{type:"",onClick:e[9]||(e[9]=(...o)=>i.nextPage&&i.nextPage(...o)),style:{float:"right"}}," Next page ")])]))])])}const Pt=O(J,[["render",wt]]);export{Pt as default};
