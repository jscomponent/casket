var z=Object.defineProperty,B=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var C=(t,e,s)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,V=(t,e)=>{for(var s in e||(e={}))S.call(e,s)&&C(t,s,e[s]);if(k)for(var s of k(e))T.call(e,s)&&C(t,s,e[s]);return t},A=(t,e)=>B(t,P(e));import{_ as E,m as f,c as d,a as i,t as g,w as c,v as h,b as N,e as R,h as y,q as v,F as m,r as b,s as j,d as x,o as n,u as _}from"./index.6cbd77e2.js";import"https://cdn.jsdelivr.net/npm/@feathersjs/client@5.0.0-pre.28/+esm";import"https://cdn.jsdelivr.net/npm/socket.io-client@4.5.1/+esm";console.log("look here",f);const O={inject:["io"],methods:{toggle(){this.custom=!this.custom},async list(){let t=await this.io.service("types/any").find({query:{slug:this.type,$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}}});this.response=t,this.listRow()},async listRow(){let t={$or:[]};this.fields.forEach(s=>{if(this.instance.fields[s].type==="String"){let u={};u[s]={$regex:this.search},t.$or.push(u)}}),(!t.$or.length||!this.search)&&delete t.$or;let e=await this.io.service("types/"+this.type).find({query:A(V({},t),{$limit:this.limit,$skip:(this.page-1)*this.limit,$sort:{createdAt:-1}})});this.responseRow=e},async create(t){await this.io.service("types/"+this.type).create(t),this.clear(),this.list()},async save(t){await this.io.service("types/"+this.type).patch(t._id,t),this.list()},async remove(t){await this.io.service("types/"+this.type).remove(t._id),this.list()},clear(){this.obj={}}},computed:{instance(){var t;return((t=this.response)==null?void 0:t.data[0])||{}},fields(){var t,e;return(t=this.instance)!=null&&t.fields?Object.keys((e=this.instance)==null?void 0:e.fields):[]},table(){var t;return((t=this.responseRow)==null?void 0:t.data)||[]},contentUrl(){var t,e,s;if((t=this.response)!=null&&t.data.length){let u=(s=(e=this.response)==null?void 0:e.data[0])==null?void 0:s.dashboard;return new TextDecoder().decode(u)}return""},loadedComponent(){console.log("loading component",this.contentUrl);let t=URL.createObjectURL(new Blob([this.contentUrl||""],{type:"text/javascript"}));console.log("url",t);let e=f(async()=>await j(()=>import(t),[]));return console.log("comp",e),e},demoA(){let t=URL.createObjectURL(new Blob([`
            export default {
                template: '<div>Hello AAA</div>'
            }
        `],{type:"text/javascript"}));return f(async()=>await j(()=>import(t),[]))},demoB(){return f(()=>new Promise(e=>{e({template:"<div>I am async!</div>"})}))}},data:()=>({obj:{},limit:25,page:1,response:null,responseRow:null,search:"",custom:!0}),props:{type:{type:String,default:"sites"}},created(){this.list()},watch:{type(){this.list()}}},q={style:{display:"flex",height:"100%","font-family":"Arial, Helvetica, sans-serif"}},I={style:{width:"100%","flex-grow":"1",flex:"1",height:"100%",overflow:"auto","background-color":"#edebebff"}},F={style:{"margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px"}},H={style:{color:"#2b2b2bff"}},K=x(),M=x(),G={key:0,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ebf2f5ff"}},J=["disabled"],Q=["disabled"],W={key:1,style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#ffffffff"}},X=x(),Y={key:2},Z={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"60px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff"}},$={style:{display:"inline-block"}},tt=i("input",{style:{"margin-right":"5px"},placeholder:"id",readonly:""},null,-1),et=["onUpdate:modelValue","placeholder"],ot={style:{display:"inline-block",float:"right"}},it={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}},rt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#83b5c9ff",position:"relative"}},lt={style:{display:"inline-block",float:"right"}},st=["onClick"],nt=["onClick"],dt=x(),at={style:{display:"inline-block",width:"100%"}},pt={style:{"font-size":"13px",position:"absolute",top:"3px",color:"#1c1c1cff","font-weight":"bold"}},gt={style:{position:"absolute",top:"3px","font-size":"13px",right:"21px",color:"#1c1c1cff","font-weight":"bold"}},ct=["onUpdate:modelValue"],ht=["onUpdate:modelValue","placeholder"],ut=["onUpdate:modelValue","placeholder"],mt=["onUpdate:modelValue","placeholder"],bt=x(),xt={style:{"box-sizing":"border-box",width:"calc(100% - 40px)","padding-left":"20px","padding-right":"20px","padding-top":"20px","padding-bottom":"20px","margin-left":"20px","margin-right":"20px","margin-top":"20px","margin-bottom":"20px","border-top-left-radius":"3px","border-top-right-radius":"3px","border-bottom-left-radius":"3px","border-bottom-right-radius":"3px","background-color":"#bacad1ff",position:"relative","text-align":"center"}};function ft(t,e,s,u,D,r){var w,U;return n(),d("div",q,[i("div",I,[i("div",F,[i("h2",H,g((U=(w=r.instance)==null?void 0:w.title)==null?void 0:U.en),1),K,i("button",{type:"",onClick:e[0]||(e[0]=(...o)=>r.list&&r.list(...o)),style:{float:"right"}}," Refresh "),c(i("input",{style:{"margin-right":"5px",width:"167px",float:"right"},"onUpdate:modelValue":e[1]||(e[1]=o=>t.search=o),placeholder:"Filter",onKeydown:e[2]||(e[2]=N((...o)=>r.list&&r.list(...o),["enter"]))},null,544),[[h,t.search]])]),M,r.contentUrl?(n(),d("div",G,[i("button",{type:"",onClick:e[3]||(e[3]=(...o)=>r.toggle&&r.toggle(...o)),disabled:t.custom}," Custom view ",8,J),i("button",{type:"",onClick:e[4]||(e[4]=(...o)=>r.toggle&&r.toggle(...o)),disabled:!t.custom}," Default view ",8,Q)])):R("",!0),t.custom&&r.contentUrl?(n(),d("div",W,[i("div",null,g(r.contentUrl),1),X,(n(),y(v(r.loadedComponent))),(n(),y(v(r.demoA))),(n(),y(v(r.demoB)))])):(n(),d("div",Y,[i("div",Z,[i("div",$,[tt,(n(!0),d(m,null,b(r.fields,o=>c((n(),d("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":l=>t.obj[o]=l,placeholder:o},null,8,et)),[[h,t.obj[o]]])),256))]),i("div",ot,[i("button",{type:"",onClick:e[5]||(e[5]=o=>r.create(t.obj))}," Create ")])]),i("div",it,[i("button",{type:"",onClick:e[6]||(e[6]=o=>(t.page--,r.list())),style:{float:"left"}}," Previous page "),i("span",null," Page "+g(t.page),1),i("button",{type:"",onClick:e[7]||(e[7]=o=>(t.page++,r.list())),style:{float:"right"}}," Next page ")]),(n(!0),d(m,null,b(r.table,o=>(n(),d("div",rt,[i("div",lt,[i("button",{type:"",style:{"margin-right":"10px"},onClick:l=>r.save(o)}," Save ",8,st),i("button",{type:"",onClick:l=>r.remove(o)}," Remove ",8,nt)]),dt,i("div",at,[i("div",null,[i("span",pt," Created "+g(new Date(o.createdAt).toLocaleString()),1),i("span",gt," Updated "+g(new Date(o.updatedAt).toLocaleString()),1)]),c(i("input",{placeholder:"ID",style:{"margin-right":"5px"},"onUpdate:modelValue":l=>o._id=l,readonly:""},null,8,ct),[[h,o._id]]),(n(!0),d(m,null,b(r.fields,l=>{var a;return c((n(),d("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":p=>o[l]=p,placeholder:l},null,8,ht)),[[h,o[l]],[_,(a=o[l])==null?void 0:a.en]])}),256)),(n(!0),d(m,null,b(r.fields,l=>{var a;return c((n(),d("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":p=>o[l]=p,placeholder:l},null,8,ut)),[[h,o[l]],[_,(a=o[l])==null?void 0:a.no]])}),256)),(n(!0),d(m,null,b(r.fields,l=>{var a,p;return c((n(),d("input",{style:{"margin-right":"5px"},"onUpdate:modelValue":L=>o[l]=L,placeholder:l},null,8,mt)),[[h,o[l]],[_,!((a=o[l])!=null&&a.en)&&!((p=o[l])!=null&&p.no)]])}),256)),bt,R("",!0)])]))),256)),i("div",xt,[i("button",{type:"",onClick:e[8]||(e[8]=o=>(t.page--,r.list())),style:{float:"left"}}," Previous page "),i("span",null," Page "+g(t.page),1),i("button",{type:"",onClick:e[9]||(e[9]=o=>(t.page++,r.list())),style:{float:"right"}}," Next page ")])]))])])}var Ut=E(O,[["render",ft]]);export{Ut as default};
